<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”¨æˆ·è¡Œä¸ºå’Œå¹¿å‘Šæ•°æ®åˆ†æå¹³å°</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.min.js"></script>
    <style>
        :root {
            --primary: #4CAF50;
            --primary-light: #E8F5E9;
            --primary-dark: #388E3C;
            --text: #333333;
            --text-light: #757575;
            --border: #C8E6C9;
            --bg: #F9FFF9;
            --card-bg: #FFFFFF;
            --hover: #E0F2F1;
            --success: #81C784;
            --warning: #FFB74D;
            --danger: #E57373;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            padding-bottom: 50px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Part1 æ ·å¼ */
        .part1 {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
            width: 220px;
            flex-shrink: 0;
        }

        .func-btn {
            padding: 14px 16px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            font-size: 15px;
            font-weight: 500;
            box-shadow: 0 2px 4px rgba(76, 175, 80, 0.2);
        }

        .func-btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(76, 175, 80, 0.3);
        }

        .func-btn.active {
            background-color: var(--primary-dark);
            box-shadow: 0 4px 8px rgba(76, 175, 80, 0.3);
            border-left: 4px solid #FFFFFF;
        }

        .func-btn .desc {
            font-size: 12px;
            opacity: 0.85;
            margin-top: 4px;
            font-weight: normal;
        }

        .code-container {
            flex: 1;
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
            background-color: var(--card-bg);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            min-height: 200px;
        }

        .code-toolbar {
            display: flex;
            justify-content: flex-end;
            padding: 10px 15px;
            background-color: var(--primary-light);
            border-bottom: 1px solid var(--border);
        }

        .code-tool {
            margin-left: 10px;
            padding: 6px 14px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: background-color 0.3s ease;
        }

        .code-tool:hover {
            background-color: var(--primary-dark);
        }

        #codeContent {
            width: 100%;
            height: calc(200px - 45px);
            padding: 18px;
            border: none;
            resize: none;
            background-color: transparent;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            line-height: 1.6;
            color: var(--text);
            tab-size: 4;
        }

        #codeContent:focus {
            outline: none;
        }

        /* Part2 ç­›é€‰æ æ ·å¼ */
        .part2 {
            background-color: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px 25px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 40px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .filter-label {
            font-weight: 500;
            color: var(--primary-dark);
            font-size: 14px;
            white-space: nowrap;
        }

        .filter-select {
            padding: 8px 14px;
            border: 1px solid var(--border);
            border-radius: 6px;
            background-color: var(--bg);
            color: var(--text);
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            min-width: 160px;
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        .time-range {
            font-size: 13px;
            color: var(--text-light);
            margin-left: 8px;
            white-space: nowrap;
        }

        /* Part3 æ•°æ®æ€»è§ˆæ ·å¼ */
        .part3 {
            margin-bottom: 35px;
            display: none;
        }

        .overview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 22px;
            background-color: var(--primary);
            border-radius: 2px;
        }

        .install-count {
            font-size: 14px;
            color: var(--text-light);
            background-color: var(--primary-light);
            padding: 6px 12px;
            border-radius: 4px;
        }

        .install-count span {
            color: var(--primary-dark);
            font-weight: 600;
            margin-left: 5px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background-color: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .data-table th, .data-table td {
            padding: 14px 16px;
            text-align: left;
            border-bottom: 1px solid var(--border);
            font-size: 14px;
        }

        .data-table th {
            background-color: var(--primary-light);
            color: var(--primary-dark);
            font-weight: 500;
            white-space: nowrap;
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        .data-table tr:hover {
            background-color: var(--hover);
        }

        .avg-row {
            background-color: #F1F8E9 !important;
            font-weight: 500;
            color: var(--primary-dark);
        }

        .rate-value {
            color: var(--primary);
            font-weight: 500;
        }

        /* Part4 é¥¼å›¾æ ·å¼ */
        .part4 {
            margin-bottom: 35px;
            display: none;
        }

        .pie-charts-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 18px;
        }

        .pie-chart-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            width: 100%;
            margin-bottom: 20px;
        }

        .pie-chart-wrapper {
            flex: 1;
            min-width: 280px;
            height: 400px;
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
        }

        .chart-title {
            text-align: center;
            font-size: 15px;
            color: var(--primary-dark);
            margin-bottom: 10px;
            font-weight: 500;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
        }

        .chart-container {
            flex: 1;
            width: 100%;
            height: calc(100% - 30px);
            /*height: 100%;*/
            
            display: /*flex;
            align-items: center;
            justify-content: center;*/
        }

        /* Part5 æŠ˜çº¿å›¾æ ·å¼ */
        .part5 {
            margin-bottom: 35px;
            display: none;
        }

        .line-chart-wrapper {
            height: 400px;
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 18px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            margin-top: 18px;
        }

        /* Part6 ç”¨æˆ·åˆ—è¡¨æ ·å¼ */
        .part6 {
            margin-bottom: 35px;
            display: none;
        }

        .user-event-container {
            display: flex;
            gap: 20px;
            margin-top: 18px;
            flex-wrap: wrap;
        }

        .user-list-wrapper {
            flex: 1;
            min-width: 320px;
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 18px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            max-height: 650px;
            overflow-y: auto;
        }

        .user-list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 18px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border);
        }

        .user-list-title {
            font-size: 15px;
            color: var(--primary-dark);
            font-weight: 600;
        }

        .sort-controls {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .sort-btn {
            padding: 5px 10px;
            border: 1px solid var(--border);
            border-radius: 4px;
            background-color: var(--bg);
            color: var(--text);
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .sort-btn:hover, .sort-btn.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .user-item {
            padding: 14px;
            border-radius: 6px;
            border: 1px solid var(--border);
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: var(--card-bg);
        }

        .user-item:hover, .user-item.active {
            background-color: var(--hover);
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
        }

        .user-info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 13px;
        }

        .user-info-row:last-child {
            margin-bottom: 0;
        }

        .user-info-label {
            color: var(--text-light);
            width: 90px;
            white-space: nowrap;
        }

        .user-info-value {
            flex: 1;
            color: var(--text);
            word-break: break-all;
        }

        .rate-group {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .rate-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 60px;
        }

        .rate-type {
            font-size: 11px;
            color: var(--text-light);
        }

        .rate-value-small {
            font-size: 12px;
            color: var(--primary);
            font-weight: 500;
        }

        .event-detail-wrapper {
            flex: 1;
            min-width: 320px;
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 18px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            max-height: 650px;
            overflow-y: auto;
        }

        .event-detail-header {
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border);
            margin-bottom: 15px;
        }

        .event-detail-title {
            font-size: 15px;
            color: var(--primary-dark);
            font-weight: 600;
            margin-bottom: 8px;
        }

        .event-detail-subtitle {
            font-size: 12px;
            color: var(--text-light);
        }

        .event-detail-empty {
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text-light);
            font-size: 14px;
            flex-direction: column;
            gap: 10px;
            padding: 20px;
        }

        .event-detail-empty i {
            font-size: 40px;
            color: var(--border);
        }

        .event-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .event-item {
            padding: 10px 12px;
            border-radius: 4px;
            background-color: var(--primary-light);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            transition: background-color 0.3s ease;
        }

        .event-item:hover {
            background-color: #DCE775;
        }

        .event-name {
            font-size: 13px;
            color: var(--primary-dark);
            font-weight: 500;
            flex: 1;
        }

        .event-time {
            font-size: 11px;
            color: var(--text-light);
            white-space: nowrap;
            margin-left: 10px;
        }

        .event-extra {
            font-size: 11px;
            color: var(--text-light);
            margin-top: 4px;
            padding-left: 2px;
        }

        /* Loadingæ ·å¼ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.85);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
            flex-direction: column;
            gap: 20px;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid var(--primary-light);
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .loading-text {
            color: var(--primary-dark);
            font-size: 16px;
            font-weight: 500;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* å¼¹çª—æ ·å¼ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }

        .modal-content {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 25px;
            width: 350px;
            max-width: 90%;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            align-content: center;
        }

        .modal-icon {
            font-size: 40px;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .modal-message {
            margin-bottom: 20px;
            color: var(--text);
            font-size: 15px;
            line-height: 1.6;
        }

        .modal-btn {
            padding: 8px 25px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-size: 14px;
            font-weight: 500;
        }

        .modal-btn:hover {
            background-color: var(--primary-dark);
        }

        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 768px) {
            .btn-group {
                width: 100%;
                flex-direction: row;
                flex-wrap: wrap;
            }

            .func-btn {
                flex: 1;
                min-width: 140px;
                text-align: center;
                padding: 12px 8px;
            }

            .func-btn .desc {
                display: none;
            }

            .part2 {
                gap: 20px;
                padding: 12px 15px;
            }

            .filter-group {
                gap: 8px;
                width: 100%;
            }

            .time-range {
                margin-left: 0;
                margin-top: 5px;
            }

            .data-table th, .data-table td {
                padding: 10px 8px;
                font-size: 12px;
            }

            .pie-chart-wrapper {
                min-width: 100%;
                height: 300px;
            }

            .user-list-wrapper, .event-detail-wrapper {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Part1: åŠŸèƒ½æŒ‰é’®ä¸ä»£ç å— -->
        <div class="part1">
            <div class="btn-group">
                <button class="func-btn" id="selectFileBtn">
                    é€‰æ‹©jsonæ–‡ä»¶
                    <div class="desc" id="fileDesc">æœªé€‰æ‹©æ–‡ä»¶</div>
                </button>
                <button class="func-btn" id="parseBtn">
                    è§£æ
                    <div class="desc">è®¡ç®—ç»“æœ</div>
                </button>
            </div>
            <div class="code-container">
                <div class="code-toolbar">
                    <button class="code-tool" id="copyCodeBtn">å¤åˆ¶</button>
                    <button class="code-tool" id="clearCodeBtn">æ¸…ç©º</button>
                </div>
                <textarea id="codeContent" readonly placeholder="é€‰æ‹©JSONæ–‡ä»¶åå°†æ˜¾ç¤ºæ–‡ä»¶å†…å®¹..."></textarea>
            </div>
        </div>

        <!-- Part2: æ¡ä»¶ç­›é€‰ -->
        <div class="part2">
            <div class="filter-group">
                <label class="filter-label">æ—¶é—´èŒƒå›´:</label>
                <select class="filter-select" id="timeRangeSelect">
                    <option value="today">ä»Šå¤©</option>
                    <option value="yesterday">æ˜¨å¤©</option>
                    <option value="3days">è¿‘3å¤©</option>
                    <option value="7days" selected>è¿‘7å¤©</option>
                    <option value="30days">è¿‘30å¤©</option>
                    <option value="90days">è¿‘90å¤©</option>
                    <option value="360days">è¿‘360å¤©</option>
                </select>
                <span class="time-range" id="timeRangeText"></span>
            </div>
            <div class="filter-group">
                <label class="filter-label">ç‰ˆæœ¬é€‰æ‹©:</label>
                <select class="filter-select" id="versionSelect">
                    <option value="all">all</option>
                </select>
            </div>
        </div>

        <!-- Part3: æ•°æ®æ€»è§ˆ -->
        <div class="part3" id="part3">
            <div class="overview-header">
                <h3 class="section-title">æ•°æ®æ€»è§ˆ</h3>
                <div class="install-count">å®‰è£…æ€»æ•°: <span id="totalInstalls">0</span></div>
            </div>
            <table class="data-table" id="overviewTable">
                <thead>
                    <tr>
                        <th>ç±»å‹</th>
                        <th>åŒ¹é…ç‡</th>
                        <th>å±•ç¤ºç‡</th>
                        <th>ç‚¹å‡»ç‡</th>
                        <th>äººå‡å±•ç¤ºä¸ªæ•°</th>
                        <th>æ€»æ•°(req/s/f - dis_s/dis_f)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr id="adoRow">
                        <td>å¼€å±å¹¿å‘Š</td>
                        <td><span class="rate-value">0.00</span>%</td>
                        <td><span class="rate-value">0.00</span>%</td>
                        <td><span class="rate-value">0.00</span>%</td>
                        <td>0.00</td>
                        <td>0/0/0 - 0/0</td>
                    </tr>
                    <tr id="adiRow">
                        <td>æ’é¡µå¹¿å‘Š</td>
                        <td><span class="rate-value">0.00</span>%</td>
                        <td><span class="rate-value">0.00</span>%</td>
                        <td><span class="rate-value">0.00</span>%</td>
                        <td>0.00</td>
                        <td>0/0/0 - 0/0</td>
                    </tr>
                    <tr id="adnRow">
                        <td>åŸç”Ÿå¹¿å‘Š</td>
                        <td><span class="rate-value">0.00</span>%</td>
                        <td><span class="rate-value">0.00</span>%</td>
                        <td><span class="rate-value">0.00</span>%</td>
                        <td>0.00</td>
                        <td>0/0/0 - 0/0</td>
                    </tr>
                    <tr class="avg-row" id="avgRow">
                        <td>å¹³å‡æ•°æ®</td>
                        <td><span class="rate-value">0.00</span>%</td>
                        <td><span class="rate-value">0.00</span>%</td>
                        <td><span class="rate-value">0.00</span>%</td>
                        <td>0.00</td>
                        <td>-</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Part4: é¥¼å›¾éƒ¨åˆ† -->
        <div class="part4" id="part4">
            <h3 class="section-title">è¯¦ç»†åˆ†å¸ƒåˆ†æ</h3>
            <div class="pie-charts-container">
                <!-- ç¬¬ä¸€è¡Œï¼šè¯·æ±‚å¤±è´¥åŸå›  -->
                <div class="pie-chart-row">
                    <div class="pie-chart-wrapper">
                        <div class="chart-title">å¼€å±å¹¿å‘Šè¯·æ±‚å¤±è´¥åŸå› </div>
                        <div class="chart-container" id="adoReqFailChart"></div>
                    </div>
                    <div class="pie-chart-wrapper">
                        <div class="chart-title">æ’é¡µå¹¿å‘Šè¯·æ±‚å¤±è´¥åŸå› </div>
                        <div class="chart-container" id="adiReqFailChart"></div>
                    </div>
                    <div class="pie-chart-wrapper">
                        <div class="chart-title">åŸç”Ÿå¹¿å‘Šè¯·æ±‚å¤±è´¥åŸå› </div>
                        <div class="chart-container" id="adnReqFailChart"></div>
                    </div>
                </div>
                <!-- ç¬¬äºŒè¡Œï¼šå±•ç¤ºå¤±è´¥åŸå›  -->
                <div class="pie-chart-row">
                    <div class="pie-chart-wrapper">
                        <div class="chart-title">å¼€å±å¹¿å‘Šå±•ç¤ºå¤±è´¥åŸå› </div>
                        <div class="chart-container" id="adoDisplayFailChart"></div>
                    </div>
                    <div class="pie-chart-wrapper">
                        <div class="chart-title">æ’é¡µå¹¿å‘Šå±•ç¤ºå¤±è´¥åŸå› </div>
                        <div class="chart-container" id="adiDisplayFailChart"></div>
                    </div>
                    <div class="pie-chart-wrapper">
                        <div class="chart-title">åŸç”Ÿå¹¿å‘Šå±•ç¤ºå¤±è´¥åŸå› </div>
                        <div class="chart-container" id="adnDisplayFailChart"></div>
                    </div>
                </div>
                <!-- ç¬¬ä¸‰è¡Œï¼šåœ°åŸŸå’Œæœºå‹åˆ†å¸ƒ -->
                <div class="pie-chart-row">
                    <div class="pie-chart-wrapper">
                        <div class="chart-title">åœ°åŸŸåˆ†å¸ƒ</div>
                        <div class="chart-container" id="countryDistributionChart"></div>
                    </div>
                    <div class="pie-chart-wrapper">
                        <div class="chart-title">æœºå‹åˆ†å¸ƒ</div>
                        <div class="chart-container" id="modelDistributionChart"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Part5: æŠ˜çº¿å›¾éƒ¨åˆ† -->
        <div class="part5" id="part5">
            <h3 class="section-title">å®‰è£…æ•°é‡æ—¶é—´è¶‹åŠ¿</h3>
            <div class="line-chart-wrapper">
                <div id="installTrendChart"></div>
            </div>
        </div>

        <!-- Part6: ç”¨æˆ·åˆ—è¡¨ä¸äº‹ä»¶è¯¦æƒ… -->
        <div class="part6" id="part6">
            <h3 class="section-title">ç”¨æˆ·è¡Œä¸ºè¯¦æƒ…</h3>
            <div class="user-event-container">
                <div class="user-list-wrapper">
                    <div class="user-list-header">
                        <div class="user-list-title">ç”¨æˆ·åˆ—è¡¨ (<span id="userCount">0</span>)</div>
                        <div class="sort-controls">
                            <button class="sort-btn active" data-sort="installTime-desc">å®‰è£…æ—¶é—´â†“</button>
                            <button class="sort-btn" data-sort="installTime-asc">å®‰è£…æ—¶é—´â†‘</button>
                            <button class="sort-btn" data-sort="adoShowRate-desc">å¼€å±å±•ç¤ºç‡â†“</button>
                            <button class="sort-btn" data-sort="adoShowRate-asc">å¼€å±å±•ç¤ºç‡â†‘</button>
                            <button class="sort-btn" data-sort="adiShowRate-desc">æ’é¡µå±•ç¤ºç‡â†“</button>
                            <button class="sort-btn" data-sort="adiShowRate-asc">æ’é¡µå±•ç¤ºç‡â†‘</button>
                            <button class="sort-btn" data-sort="adnShowRate-desc">åŸç”Ÿå±•ç¤ºç‡â†“</button>
                            <button class="sort-btn" data-sort="adnShowRate-asc">åŸç”Ÿå±•ç¤ºç‡â†‘</button>
                        </div>
                    </div>
                    <div id="userListContainer"></div>
                </div>
                <div class="event-detail-wrapper">
                    <div class="event-detail-empty" id="eventEmptyTip">
                        <i>ğŸ“‹</i>
                        <div>è¯·é€‰æ‹©ä¸€ä¸ªç”¨æˆ·æŸ¥çœ‹äº‹ä»¶è¯¦æƒ…</div>
                    </div>
                    <div id="eventDetailContainer" style="display: none;">
                        <div class="event-detail-header">
                            <div class="event-detail-title">ç”¨æˆ·äº‹ä»¶è¯¦æƒ…</div>
                            <div class="event-detail-subtitle" id="eventUserSubtitle"></div>
                        </div>
                        <div class="event-list" id="eventList"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loadingå¼¹çª— -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">æ­£åœ¨è§£ææ•°æ®ï¼Œè¯·ç¨å€™...</div>
    </div>

    <!-- æç¤ºå¼¹çª— -->
    <div class="modal" id="alertModal">
        <div class="modal-content">
            <div class="modal-icon">â„¹ï¸</div>
            <div class="modal-message" id="alertMessage"></div>
            <button class="modal-btn" id="alertConfirmBtn">ç¡®è®¤</button>
        </div>
    </div>

    <script>
              // å…¨å±€å˜é‡
let originalJson = null; // åŸå§‹JSONæ•°æ®
let currentTimeRange = '7days'; // å½“å‰æ—¶é—´èŒƒå›´
let currentVersion = 'all'; // å½“å‰ç‰ˆæœ¬
let userDataList = []; // ç”¨æˆ·æ•°æ®åˆ—è¡¨
let adStats = { // å¹¿å‘Šç»Ÿè®¡æ•°æ®
    ado: { reqStart: 0, reqSuccess: 0, reqFail: 0, displaySuccess: 0, displayFail: 0, click: 0, reqFailReasons: {}, displayFailReasons: {} },
    adi: { reqStart: 0, reqSuccess: 0, reqFail: 0, displaySuccess: 0, displayFail: 0, click: 0, reqFailReasons: {}, displayFailReasons: {} },
    adn: { reqStart: 0, reqSuccess: 0, reqFail: 0, displaySuccess: 0, displayFail: 0, click: 0, reqFailReasons: {}, displayFailReasons: {} }
};
let countryStats = {}; // å›½å®¶ç»Ÿè®¡
let modelStats = {}; // æœºå‹ç»Ÿè®¡
let installTrendData = {}; // å®‰è£…è¶‹åŠ¿æ•°æ®
let versions = new Set(); // ç‰ˆæœ¬åˆ—è¡¨
let charts = {}; // å­˜å‚¨æ‰€æœ‰å›¾è¡¨å®ä¾‹

// å›½å®¶ä»£ç -åç§°æ˜ å°„
const countryCodeMap = {
    'CN': 'ä¸­å›½', 'US': 'ç¾å›½', 'HK': 'ä¸­å›½é¦™æ¸¯', 'TW': 'ä¸­å›½å°æ¹¾', 'UK': 'è‹±å›½',
    'JP': 'æ—¥æœ¬', 'KR': 'éŸ©å›½', 'SG': 'æ–°åŠ å¡', 'MY': 'é©¬æ¥è¥¿äºš', 'TH': 'æ³°å›½',
    'VN': 'è¶Šå—', 'ID': 'å°åº¦å°¼è¥¿äºš', 'PH': 'è²å¾‹å®¾', 'IN': 'å°åº¦', 'PK': 'å·´åŸºæ–¯å¦',
    'BD': 'å­ŸåŠ æ‹‰å›½', 'NG': 'å°¼æ—¥åˆ©äºš', 'EG': 'åŸƒåŠ', 'ZA': 'å—é', 'DE': 'å¾·å›½',
    'FR': 'æ³•å›½', 'IT': 'æ„å¤§åˆ©', 'ES': 'è¥¿ç­ç‰™', 'RU': 'ä¿„ç½—æ–¯', 'CA': 'åŠ æ‹¿å¤§',
    'AU': 'æ¾³å¤§åˆ©äºš', 'NZ': 'æ–°è¥¿å…°', 'BR': 'å·´è¥¿', 'AR': 'é˜¿æ ¹å»·', 'MX': 'å¢¨è¥¿å“¥',
    'CH': 'ç‘å£«', 'AT': 'å¥¥åœ°åˆ©', 'BE': 'æ¯”åˆ©æ—¶', 'NL': 'è·å…°', 'SE': 'ç‘å…¸',
    'NO': 'æŒªå¨', 'DK': 'ä¸¹éº¦', 'FI': 'èŠ¬å…°', 'IE': 'çˆ±å°”å…°', 'PT': 'è‘¡è„ç‰™',
    'GR': 'å¸Œè…Š', 'TR': 'åœŸè€³å…¶', 'SA': 'æ²™ç‰¹é˜¿æ‹‰ä¼¯', 'AE': 'é˜¿è”é…‹', 'IL': 'ä»¥è‰²åˆ—',
    "IQ":"ä¼Šæ‹‰å…‹", "DZ":"é˜¿å°”åŠåˆ©äºš"
};

// è¯­è¨€ä»£ç -åç§°æ˜ å°„
const langCodeMap = {
    'zh': 'ä¸­æ–‡', 'en': 'è‹±è¯­', 'ja': 'æ—¥è¯­', 'ko': 'éŸ©è¯­', 'fr': 'æ³•è¯­',
    'de': 'å¾·è¯­', 'es': 'è¥¿ç­ç‰™è¯­', 'ru': 'ä¿„è¯­', 'pt': 'è‘¡è„ç‰™è¯­', 'ar': 'é˜¿æ‹‰ä¼¯è¯­',
    'hi': 'å°åœ°è¯­', 'bn': 'å­ŸåŠ æ‹‰è¯­', 'ur': 'ä¹Œå°”éƒ½è¯­', 'id': 'å°å°¼è¯­', 'ms': 'é©¬æ¥è¯­',
    'th': 'æ³°è¯­', 'vi': 'è¶Šå—è¯­', 'tr': 'åœŸè€³å…¶è¯­', 'it': 'æ„å¤§åˆ©è¯­', 'nl': 'è·å…°è¯­',
    'sv': 'ç‘å…¸è¯­', 'no': 'æŒªå¨è¯­', 'da': 'ä¸¹éº¦è¯­', 'fi': 'èŠ¬å…°è¯­', 'pl': 'æ³¢å…°è¯­',
    'cs': 'æ·å…‹è¯­', 'hu': 'åŒˆç‰™åˆ©è¯­', 'ro': 'ç½—é©¬å°¼äºšè¯­', 'el': 'å¸Œè…Šè¯­', 'he': 'å¸Œä¼¯æ¥è¯­'
};

// å¹¿å‘Šäº‹ä»¶åç§°æ˜ å°„ï¼ˆç»Ÿä¸€æ ‡å‡†äº‹ä»¶åï¼‰
const adEventMap = {
    // å¼€å±å¹¿å‘Š
    'ad_open_req_start': 'ado_req_start',
    'ad_open_req_success': 'ado_req_success',
    'ad_open_req_fail': 'ado_req_fail',
    'ad_open_display_start': 'ado_display_start',
    'ad_open_display_success': 'ado_display_success',
    'ad_open_display_fail': 'ado_display_fail',
    'ad_open_click': 'ado_click',
    // æ’é¡µå¹¿å‘Š
    'ad_inter_req_start': 'adi_req_start',
    'ad_inter_req_success': 'adi_req_success',
    'ad_inter_req_fail': 'adi_req_fail',
    'ad_inter_display_start': 'adi_display_start',
    'ad_inter_display_success': 'adi_display_success',
    'ad_inter_display_fail': 'adi_display_fail',
    'ad_inter_click': 'adi_click',
    // åŸç”Ÿå¹¿å‘Š
    'ad_native_req_start': 'adn_req_start',
    'ad_native_req_success': 'adn_req_success',
    'ad_native_req_fail': 'adn_req_fail',
    'ad_native_display_start': 'adn_display_start',
    'ad_native_display_success': 'adn_display_success',
    'ad_native_display_fail': 'adn_display_fail',
    'ad_native_click': 'adn_click'
};

// åˆå§‹åŒ–é¡µé¢ - ç®€åŒ–DOMåŠ è½½é€»è¾‘ï¼Œç¡®ä¿æ–‡ä»¶é€‰æ‹©åŠŸèƒ½æ­£å¸¸
$(document).ready(function() {
    // ç›´æ¥åˆå§‹åŒ–æ ¸å¿ƒåŠŸèƒ½ï¼Œé¿å…åµŒå¥—äº‹ä»¶å†²çª
    updateTimeRangeText();
    bindButtonEvents();
    initCharts();
});

// ç»‘å®šæŒ‰é’®äº‹ä»¶ - é‡ç‚¹ä¿®å¤æ–‡ä»¶é€‰æ‹©åŠŸèƒ½
function bindButtonEvents() {
    // é€‰æ‹©æ–‡ä»¶æŒ‰é’® - ä¿®å¤äº‹ä»¶ç»‘å®šï¼Œç¡®ä¿æ–‡ä»¶é€‰æ‹©æ¡†æ­£å¸¸å¼¹å‡º
    $('#selectFileBtn').off('click').on('click', function() {
        $(this).addClass('active').siblings().removeClass('active');
        
        // ç›´æ¥åˆ›å»ºå¹¶è§¦å‘æ–‡ä»¶è¾“å…¥æ¡†ï¼Œé¿å…DOMæ’å…¥é—®é¢˜
        const fileInput = document.createElement('input');
        fileInput.type = 'file';
        fileInput.accept = '.json';
        fileInput.style.display = 'none';
        
        // æ–‡ä»¶é€‰æ‹©å›è°ƒ
        fileInput.onchange = function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            $('#fileDesc').text(file.name);
            const reader = new FileReader();
            
            reader.onload = function(event) {
                try {
                    originalJson = JSON.parse(event.target.result);
                    const formattedJson = JSON.stringify(originalJson, null, 2);
                    $('#codeContent').val(formattedJson).prop('readonly', true);
                    extractVersions(originalJson);
                    showAlert('æ–‡ä»¶é€‰æ‹©æˆåŠŸï¼');
                } catch (err) {
                    showAlert('JSONæ–‡ä»¶è§£æå¤±è´¥ï¼š' + err.message);
                    originalJson = null;
                    $('#codeContent').val('JSONæ–‡ä»¶è§£æå¤±è´¥ï¼š' + err.message);
                }
            };
            
            reader.onerror = function() {
                showAlert('æ–‡ä»¶è¯»å–å¤±è´¥ï¼Œè¯·é‡è¯•');
            };
            
            reader.readAsText(file);
        };
        
        // è§¦å‘æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†
        fileInput.click();
    });

    // è§£ææŒ‰é’®
    $('#parseBtn').off('click').on('click', function() {
        $(this).addClass('active').siblings().removeClass('active');
        if (!originalJson) {
            showAlert('è¯·å…ˆé€‰æ‹©jsonæ–‡ä»¶');
            return;
        }
        
        $('#loadingOverlay').show();
        setTimeout(() => {
            try {
                resetStats();
                parseJsonData(originalJson);
                renderAllSections();
                $('#loadingOverlay').hide();
            } catch (err) {
                $('#loadingOverlay').hide();
                showAlert('è§£æå¤±è´¥ï¼š' + err.message);
                console.error('è§£æé”™è¯¯è¯¦æƒ…ï¼š', err);
            }
        }, 300);
    });

    // å¤åˆ¶ä»£ç æŒ‰é’®
    $('#copyCodeBtn').off('click').on('click', function() {
        const codeContent = $('#codeContent').val();
        if (!codeContent || codeContent === 'é€‰æ‹©JSONæ–‡ä»¶åå°†æ˜¾ç¤ºæ–‡ä»¶å†…å®¹...') {
            showAlert('æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹ï¼');
            return;
        }
        navigator.clipboard.writeText(codeContent).then(() => {
            showAlert('å¤åˆ¶æˆåŠŸï¼');
        }).catch(err => {
            showAlert('å¤åˆ¶å¤±è´¥ï¼š' + err.message);
        });
    });

    // æ¸…ç©ºä»£ç æŒ‰é’®
    $('#clearCodeBtn').off('click').on('click', function() {
        $('#codeContent').val('é€‰æ‹©JSONæ–‡ä»¶åå°†æ˜¾ç¤ºæ–‡ä»¶å†…å®¹...').prop('readonly', true);
    });

    // æ—¶é—´èŒƒå›´é€‰æ‹©å˜åŒ–
    $('#timeRangeSelect').off('change').on('change', function() {
        currentTimeRange = $(this).val();
        updateTimeRangeText();
        if (originalJson) {
            $('#loadingOverlay').show();
            setTimeout(() => {
                try {
                    resetStats();
                    parseJsonData(originalJson);
                    renderAllSections();
                    $('#loadingOverlay').hide();
                } catch (err) {
                    $('#loadingOverlay').hide();
                    showAlert('è§£æå¤±è´¥ï¼š' + err.message);
                    console.error('è§£æé”™è¯¯è¯¦æƒ…ï¼š', err);
                }
            }, 300);
        }
    });

    // ç‰ˆæœ¬é€‰æ‹©å˜åŒ–
    $('#versionSelect').off('change').on('change', function() {
        currentVersion = $(this).val();
        if (originalJson) {
            $('#loadingOverlay').show();
            setTimeout(() => {
                try {
                    resetStats();
                    parseJsonData(originalJson);
                    renderAllSections();
                    $('#loadingOverlay').hide();
                } catch (err) {
                    $('#loadingOverlay').hide();
                    showAlert('è§£æå¤±è´¥ï¼š' + err.message);
                    console.error('è§£æé”™è¯¯è¯¦æƒ…ï¼š', err);
                }
            }, 300);
        }
    });

    // æ’åºæŒ‰é’®äº‹ä»¶
    $('.sort-btn').off('click').on('click', function() {
        const sortType = $(this).data('sort');
        $(this).addClass('active').siblings().removeClass('active');
        sortUserList(sortType);
        renderUserList();
    });

    // å¼¹çª—ç¡®è®¤æŒ‰é’®
    $('#alertConfirmBtn').off('click').on('click', function() {
        $('#alertModal').hide();
    });
}

// æå–æ‰€æœ‰ç‰ˆæœ¬
function extractVersions(jsonData) {
    versions.clear();
    Object.values(jsonData).forEach(userData => {
        if (userData.userinfo && userData.userinfo.version) {
            versions.add(userData.userinfo.version);
        }
    });
    
    const versionSelect = $('#versionSelect');
    const currentVal = versionSelect.val();
    versionSelect.find('option:not([value="all"])').remove();
    
    Array.from(versions).sort((a, b) => {
        const aParts = a.split('.').map(Number);
        const bParts = b.split('.').map(Number);
        const maxLen = Math.max(aParts.length, bParts.length);
        for (let i = 0; i < maxLen; i++) {
            const aVal = aParts[i] || 0;
            const bVal = bParts[i] || 0;
            if (aVal !== bVal) {
                return bVal - aVal;
            }
        }
        return 0;
    }).forEach(version => {
        versionSelect.append(`<option value="${version}">${version}</option>`);
    });
    
    if (currentVal !== 'all' && versions.has(currentVal)) {
        versionSelect.val(currentVal);
    }
}

// é‡ç½®ç»Ÿè®¡æ•°æ®
function resetStats() {
    adStats = {
        ado: { reqStart: 0, reqSuccess: 0, reqFail: 0, displaySuccess: 0, displayFail: 0, click: 0, reqFailReasons: {}, displayFailReasons: {} },
        adi: { reqStart: 0, reqSuccess: 0, reqFail: 0, displaySuccess: 0, displayFail: 0, click: 0, reqFailReasons: {}, displayFailReasons: {} },
        adn: { reqStart: 0, reqSuccess: 0, reqFail: 0, displaySuccess: 0, displayFail: 0, click: 0, reqFailReasons: {}, displayFailReasons: {} }
    };
    countryStats = {};
    modelStats = {};
    installTrendData = {};
    userDataList = [];
}

// è·å–æ—¶é—´èŒƒå›´ï¼ˆå¼ºåˆ¶æœ¬åœ°æ—¶é—´ï¼‰
function getTimeRange(rangeType) {
    const now = new Date(); // æœ¬åœ°æ—¶é—´
    let endTime = Math.floor(now.getTime() / 1000);
    let startTime = 0;

    switch (rangeType) {
        case 'today':
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            startTime = Math.floor(today.getTime() / 1000);
            break;
        case 'yesterday':
            const yesterday = new Date(now.getFullYear(), now.getMonth(), now.getDate() - 1);
            startTime = Math.floor(yesterday.getTime() / 1000);
            endTime = Math.floor(new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime() / 1000);
            break;
        case '3days':
            const threeDaysAgo = new Date(now.getFullYear(), now.getMonth(), now.getDate() - 2);
            startTime = Math.floor(threeDaysAgo.getTime() / 1000);
            break;
        case '7days':
            const sevenDaysAgo = new Date(now.getFullYear(), now.getMonth(), now.getDate() - 6);
            startTime = Math.floor(sevenDaysAgo.getTime() / 1000);
            break;
        case '30days':
            const thirtyDaysAgo = new Date(now.getFullYear(), now.getMonth(), now.getDate() - 29);
            startTime = Math.floor(thirtyDaysAgo.getTime() / 1000);
            break;
        case '90days':
            const ninetyDaysAgo = new Date(now.getFullYear(), now.getMonth(), now.getDate() - 89);
            startTime = Math.floor(ninetyDaysAgo.getTime() / 1000);
            break;
        case '360days':
            const threeHundredSixtyDaysAgo = new Date(now.getFullYear(), now.getMonth(), now.getDate() - 359);
            startTime = Math.floor(threeHundredSixtyDaysAgo.getTime() / 1000);
            break;
    }

    return { startTime, endTime };
}

// æ›´æ–°æ—¶é—´èŒƒå›´æ˜¾ç¤ºæ–‡æœ¬ï¼ˆå¼ºåˆ¶æœ¬åœ°æ—¶é—´ï¼‰
function updateTimeRangeText() {
    const { startTime, endTime } = getTimeRange(currentTimeRange);
    const startDate = formatDate(startTime * 1000);
    const endDate = formatDate(endTime * 1000);
    $('#timeRangeText').text(`(${startDate} ~ ${endDate})`);
}

// æ ¼å¼åŒ–æ—¥æœŸï¼ˆç²¾ç¡®åˆ°å¤©ï¼Œå¼ºåˆ¶æœ¬åœ°æ—¶é—´ï¼‰
function formatDate(timestamp) {
    const date = new Date(timestamp);
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0'); // æœ¬åœ°æ—¶é—´æœˆä»½ï¼ˆ0-11ï¼‰
    const day = String(date.getDate()).padStart(2, '0'); // æœ¬åœ°æ—¶é—´æ—¥æœŸ
    return `${year}-${month}-${day}`;
}

// æ ¼å¼åŒ–æ—¶é—´æˆ³ï¼ˆç²¾ç¡®åˆ°æ¯«ç§’ï¼Œå¼ºåˆ¶æœ¬åœ°æ—¶é—´ï¼‰
function formatTimestamp(timestamp) {
    // å¤„ç†ç§’çº§/æ¯«ç§’çº§æ—¶é—´æˆ³
    // if (timestamp.toString().length < 13) {
        timestamp = timestamp * 1000;  // ç§’è½¬æ¢ä¸ºæ¯«ç§’
    // }
    const date = new Date(timestamp);
    // å…¨éƒ¨ä½¿ç”¨æœ¬åœ°æ—¶é—´æ–¹æ³•
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    const hour = String(date.getHours()).padStart(2, '0'); // æœ¬åœ°æ—¶é—´ï¼ˆ0-23ï¼‰
    const minute = String(date.getMinutes()).padStart(2, '0'); // æœ¬åœ°æ—¶é—´
    const second = String(date.getSeconds()).padStart(2, '0'); // æœ¬åœ°æ—¶é—´
    const millisecond = String(date.getMilliseconds()).padStart(3, '0'); // æœ¬åœ°æ—¶é—´
    return `${year}-${month}-${day} ${hour}:${minute}:${second}.${millisecond}`;
}

// è§£æJSONæ•°æ®
function parseJsonData(jsonData) {
    const { startTime, endTime } = getTimeRange(currentTimeRange);
    
    Object.values(jsonData).forEach(userData => {
        if (!userData.userinfo || !userData.userinfo.id) return;
        
        const userInfo = userData.userinfo;
        const userId = userInfo.id;
        const installTime = userInfo.install_time || userInfo.timestamp;
        const version = userInfo.version || 'unknown';
        const country = (userInfo.country || 'unknown').toUpperCase();
        const lang = (userInfo.lan || 'unknown').toLowerCase();
        const model = userInfo.model || 'unknown';
        console.log('å®‰è£…æ—¶é—´',formatTimestamp(installTime))
        console.log('å¼€å§‹æ—¶é—´',formatTimestamp(startTime))
        console.log('ç»“æŸæ—¶é—´',formatTimestamp(endTime))
        if (currentVersion !== 'all' && version !== currentVersion) return;
        if (installTime < startTime || installTime > endTime) return;

        const userStats = {
            userId,
            installTime,
            version,
            country,
            lang,
            model,
            ado: { reqStart: 0, reqSuccess: 0, reqFail: 0, displaySuccess: 0, displayFail: 0, click: 0 },
            adi: { reqStart: 0, reqSuccess: 0, reqFail: 0, displaySuccess: 0, displayFail: 0, click: 0 },
            adn: { reqStart: 0, reqSuccess: 0, reqFail: 0, displaySuccess: 0, displayFail: 0, click: 0 },
            events: []
        };

        // å¤„ç†å¹¿å‘Šäº‹ä»¶
        if (userData.ad_event && typeof userData.ad_event === 'object') {
            Object.values(userData.ad_event).forEach(event => {
                if (!event.event_name || !event.timestamp) return;
                
                const eventName = adEventMap[event.event_name] || event.event_name;
                const eventTime = event.timestamp;
                
                if (eventTime < startTime || eventTime > endTime) return;

                userStats.events.push({
                    type: 'ad_event',
                    eventName: event.event_name,
                    timestamp: eventTime,
                    failReason: event.fail_reason || '',
                    extra: JSON.stringify(event, (k, v) => k === 'event_name' || k === 'timestamp' || k === 'fail_reason' ? undefined : v)
                });

                switch (true) {
                    case eventName.startsWith('ado_'):
                        updateAdStats('ado', eventName, event.fail_reason, userStats.ado);
                        break;
                    case eventName.startsWith('adi_'):
                        updateAdStats('adi', eventName, event.fail_reason, userStats.adi);
                        break;
                    case eventName.startsWith('adn_'):
                        updateAdStats('adn', eventName, event.fail_reason, userStats.adn);
                        break;
                }
            });
        }

        // å¤„ç†é¡µé¢äº‹ä»¶
        if (userData.vc_event && typeof userData.vc_event === 'object') {
            Object.values(userData.vc_event).forEach(event => {
                if (!event.event_name || !event.timestamp) return;
                
                const eventTime = event.timestamp;
                if (eventTime < startTime || eventTime > endTime) return;

                userStats.events.push({
                    type: 'vc_event',
                    eventName: event.event_name,
                    timestamp: eventTime,
                    failReason: '',
                    extra: JSON.stringify(event, (k, v) => k === 'event_name' || k === 'timestamp' ? undefined : v)
                });
            });
        }

        // æ’åºäº‹ä»¶ï¼ˆæœ¬åœ°æ—¶é—´é¡ºåºï¼‰
        userStats.events.sort((a, b) => a.timestamp - b.timestamp);
        calculateUserRates(userStats);
        updateCountryStats(country);
        updateModelStats(model);
        updateInstallTrend(installTime);
        userDataList.push(userStats);
    });

    calculateAverageRates();
}

// æ›´æ–°å¹¿å‘Šç»Ÿè®¡
function updateAdStats(adType, eventName, failReason, userAdStats) {
    switch (eventName) {
        case `${adType}_req_start`:
            adStats[adType].reqStart++;
            userAdStats.reqStart++;
            break;
        case `${adType}_req_success`:
            adStats[adType].reqSuccess++;
            userAdStats.reqSuccess++;
            break;
        case `${adType}_req_fail`:
            adStats[adType].reqFail++;
            userAdStats.reqFail++;
            const reason = failReason || 'æœªçŸ¥åŸå› ';
            adStats[adType].reqFailReasons[reason] = (adStats[adType].reqFailReasons[reason] || 0) + 1;
            break;
        case `${adType}_display_success`:
            adStats[adType].displaySuccess++;
            userAdStats.displaySuccess++;
            break;
        case `${adType}_display_fail`:
            adStats[adType].displayFail++;
            userAdStats.displayFail++;
            const displayReason = failReason || 'æœªçŸ¥åŸå› ';
            adStats[adType].displayFailReasons[displayReason] = (adStats[adType].displayFailReasons[displayReason] || 0) + 1;
            break;
        case `${adType}_click`:
            adStats[adType].click++;
            userAdStats.click++;
            break;
    }
}

// è®¡ç®—ç”¨æˆ·çº§æ¯”ç‡
function calculateUserRates(userStats) {
    // å¼€å±å¹¿å‘Šæ¯”ç‡
    userStats.ado.matchRate = userStats.ado.reqStart > 0 ? (userStats.ado.reqSuccess / userStats.ado.reqStart) * 100 : 0;
    userStats.ado.showRate = userStats.ado.reqSuccess > 0 ? (userStats.ado.displaySuccess / userStats.ado.reqSuccess) * 100 : 0;
    userStats.ado.clickRate = userStats.ado.displaySuccess > 0 ? (userStats.ado.click / userStats.ado.displaySuccess) * 100 : 0;

    // æ’é¡µå¹¿å‘Šæ¯”ç‡
    userStats.adi.matchRate = userStats.adi.reqStart > 0 ? (userStats.adi.reqSuccess / userStats.adi.reqStart) * 100 : 0;
    userStats.adi.showRate = userStats.adi.reqSuccess > 0 ? (userStats.adi.displaySuccess / userStats.adi.reqSuccess) * 100 : 0;
    userStats.adi.clickRate = userStats.adi.displaySuccess > 0 ? (userStats.adi.click / userStats.adi.displaySuccess) * 100 : 0;

    // åŸç”Ÿå¹¿å‘Šæ¯”ç‡
    userStats.adn.matchRate = userStats.adn.reqStart > 0 ? (userStats.adn.reqSuccess / userStats.adn.reqStart) * 100 : 0;
    userStats.adn.showRate = userStats.adn.reqSuccess > 0 ? (userStats.adn.displaySuccess / userStats.adn.reqSuccess) * 100 : 0;
    userStats.adn.clickRate = userStats.adn.displaySuccess > 0 ? (userStats.adn.click / userStats.adn.displaySuccess) * 100 : 0;
}

// è®¡ç®—æ€»ä½“å¹³å‡æ¯”ç‡
function calculateAverageRates() {
    const userCount = userDataList.length;
    if (userCount === 0) return;

    const adoAvgMatchRate = userDataList.reduce((sum, user) => sum + user.ado.matchRate, 0) / userCount;
    const adoAvgShowRate = userDataList.reduce((sum, user) => sum + user.ado.showRate, 0) / userCount;
    const adoAvgClickRate = userDataList.reduce((sum, user) => sum + user.ado.clickRate, 0) / userCount;

    const adiAvgMatchRate = userDataList.reduce((sum, user) => sum + user.adi.matchRate, 0) / userCount;
    const adiAvgShowRate = userDataList.reduce((sum, user) => sum + user.adi.showRate, 0) / userCount;
    const adiAvgClickRate = userDataList.reduce((sum, user) => sum + user.adi.clickRate, 0) / userCount;

    const adnAvgMatchRate = userDataList.reduce((sum, user) => sum + user.adn.matchRate, 0) / userCount;
    const adnAvgShowRate = userDataList.reduce((sum, user) => sum + user.adn.showRate, 0) / userCount;
    const adnAvgClickRate = userDataList.reduce((sum, user) => sum + user.adn.clickRate, 0) / userCount;

    adStats.avgMatchRate = (adoAvgMatchRate + adiAvgMatchRate + adnAvgMatchRate) / 3;
    adStats.avgShowRate = (adoAvgShowRate + adiAvgShowRate + adnAvgShowRate) / 3;
    adStats.avgClickRate = (adoAvgClickRate + adiAvgClickRate + adnAvgClickRate) / 3;

    adStats.ado.perCapitaShow = userCount > 0 ? adStats.ado.displaySuccess / userCount : 0;
    adStats.adi.perCapitaShow = userCount > 0 ? adStats.adi.displaySuccess / userCount : 0;
    adStats.adn.perCapitaShow = userCount > 0 ? adStats.adn.displaySuccess / userCount : 0;
    adStats.avgPerCapitaShow = (adStats.ado.perCapitaShow + adStats.adi.perCapitaShow + adStats.adn.perCapitaShow) / 3;
}

// æ›´æ–°å›½å®¶ç»Ÿè®¡
function updateCountryStats(country) {
    countryStats[country] = (countryStats[country] || 0) + 1;
}

// æ›´æ–°æœºå‹ç»Ÿè®¡
function updateModelStats(model) {
    modelStats[model] = (modelStats[model] || 0) + 1;
}

// æ›´æ–°å®‰è£…è¶‹åŠ¿ï¼ˆæŒ‰æœ¬åœ°æ—¶é—´æ—¥æœŸåˆ†ç»„ï¼‰
function updateInstallTrend(installTime) {
    const date = formatDate(installTime * 1000); // æœ¬åœ°æ—¶é—´æ—¥æœŸ
    installTrendData[date] = (installTrendData[date] || 0) + 1;
}

// æ¸²æŸ“æ‰€æœ‰éƒ¨åˆ†
function renderAllSections() {
    $('#part3, #part4, #part5, #part6').show();
    renderOverviewTable();
    
    // ç¡®ä¿å®¹å™¨å°ºå¯¸ç”Ÿæ•ˆåæ¸²æŸ“å›¾è¡¨
    setTimeout(() => {

        // å¼ºåˆ¶è§¦å‘å®¹å™¨å°ºå¯¸è®¡ç®—
        // const chartContainers = document.querySelectorAll('.chart-container');
        // chartContainers.forEach(container => {
        //     container.style.display = 'none';
        //     container.offsetHeight; // è§¦å‘é‡ç»˜
        //     container.style.display = 'flex';
        // });

        // const chartContainers = document.querySelectorAll('.part4');
        // chartContainers.forEach(container => {
        //     container.style.display = 'none';
        //     container.offsetHeight; // è§¦å‘é‡ç»˜
        //     container.style.display = 'flex';
        // });


        renderPieCharts();
        renderLineChart();

        Object.values(charts).forEach(chart => {
                try {
                    chart.resize();
                } catch (err) {
                    console.error('å›¾è¡¨resizeé”™è¯¯ï¼š', err);
                }
            });

    }, 200); // å»¶é•¿å»¶è¿Ÿï¼Œç¡®ä¿å®¹å™¨å®Œå…¨æ¸²æŸ“
    
    renderUserList();
}

// æ¸²æŸ“æ•°æ®æ€»è§ˆè¡¨æ ¼
function renderOverviewTable() {
    const userCount = userDataList.length;
    $('#totalInstalls').text(userCount);
    $('#userCount').text(userCount);

    renderAdRow('ado', adStats.ado);
    renderAdRow('adi', adStats.adi);
    renderAdRow('adn', adStats.adn);

    let r1 = "0.0"
    if (adStats && typeof adStats.avgMatchRate === 'number') {
        r1 = adStats.avgMatchRate.toFixed(2)
    }

    let r2 = "0.0"
    if (adStats && typeof adStats.avgShowRate === 'number') {
        r2 = adStats.avgShowRate.toFixed(2)
    }

    let r3 = "0.0"
    if (adStats && typeof adStats.avgClickRate === 'number') {
        r3 = adStats.avgClickRate.toFixed(2)
    }

    let r4 = "0.0"
    if (adStats && typeof adStats.avgPerCapitaShow === 'number') {
        r4 = adStats.avgPerCapitaShow.toFixed(2)
    }



    $('#avgRow').find('td').eq(1).find('.rate-value').text(r1); 
    $('#avgRow').find('td').eq(2).find('.rate-value').text(r2);
    $('#avgRow').find('td').eq(3).find('.rate-value').text(r3);
    $('#avgRow').find('td').eq(4).text(r4);
}

// æ¸²æŸ“å•ä¸ªå¹¿å‘Šç±»å‹è¡Œ
function renderAdRow(adType, stats) {
    const row = $(`#${adType}Row`);
    const matchRate = stats.reqStart > 0 ? (stats.reqSuccess / stats.reqStart) * 100 : 0;
    const showRate = stats.reqSuccess > 0 ? (stats.displaySuccess / stats.reqSuccess) * 100 : 0;
    const clickRate = stats.displaySuccess > 0 ? (stats.click / stats.displaySuccess) * 100 : 0;
    const perCapitaShow = userDataList.length > 0 ? stats.displaySuccess / userDataList.length : 0;
    const totalText = `${stats.reqStart}/${stats.reqSuccess}/${stats.reqFail} - ${stats.displaySuccess}/${stats.displayFail}`;

    row.find('td').eq(1).find('.rate-value').text(matchRate.toFixed(2));
    row.find('td').eq(2).find('.rate-value').text(showRate.toFixed(2));
    row.find('td').eq(3).find('.rate-value').text(clickRate.toFixed(2));
    row.find('td').eq(4).text(perCapitaShow.toFixed(2));
    row.find('td').eq(5).text(totalText);
}

// åˆå§‹åŒ–æ‰€æœ‰å›¾è¡¨ï¼ˆå¼ºåŒ–æŠ˜çº¿å›¾å®¹å™¨è®¾ç½®ï¼‰
function initCharts() {
    try {
        // å¼ºåˆ¶è®¾ç½®å›¾è¡¨å®¹å™¨å°ºå¯¸ï¼ˆé‡ç‚¹ä¼˜åŒ–æŠ˜çº¿å›¾å®¹å™¨ï¼‰
        $('.chart-container').css({
            width: '100%',
            height: '400px', // å›ºå®šé«˜åº¦ï¼Œç¡®ä¿æ¸²æŸ“åŒºåŸŸ
            minHeight: '300px',
            display: 'block', // ç¡®ä¿æ˜¯å—çº§å…ƒç´ 
            margin: '0 auto'
        });

        // å•ç‹¬å¼ºåŒ–æŠ˜çº¿å›¾å®¹å™¨å°ºå¯¸
        $('#installTrendChart').css({
            height: '450px', // æŠ˜çº¿å›¾é«˜åº¦ç•¥é«˜ï¼Œæå‡æ˜¾ç¤ºæ•ˆæœ
            width: '100%'
        });

        // åˆå§‹åŒ–æ‰€æœ‰å›¾è¡¨å®ä¾‹
        charts.adoReqFail = echarts.init(document.getElementById('adoReqFailChart'));
        charts.adiReqFail = echarts.init(document.getElementById('adiReqFailChart'));
        charts.adnReqFail = echarts.init(document.getElementById('adnReqFailChart'));
        charts.adoDisplayFail = echarts.init(document.getElementById('adoDisplayFailChart'));
        charts.adiDisplayFail = echarts.init(document.getElementById('adiDisplayFailChart'));
        charts.adnDisplayFail = echarts.init(document.getElementById('adnDisplayFailChart'));
        charts.countryDistribution = echarts.init(document.getElementById('countryDistributionChart'));
        charts.modelDistribution = echarts.init(document.getElementById('modelDistributionChart'));
        
        // æŠ˜çº¿å›¾å®ä¾‹å•ç‹¬åˆå§‹åŒ–ï¼Œå¢åŠ é”™è¯¯æ•è·
        try {
            charts.installTrend = echarts.init(document.getElementById('installTrendChart'));
            console.log('æŠ˜çº¿å›¾å®ä¾‹åˆå§‹åŒ–æˆåŠŸ');
        } catch (err) {
            console.error('æŠ˜çº¿å›¾å®ä¾‹åˆå§‹åŒ–å¤±è´¥ï¼š', err);
            showAlert('æŠ˜çº¿å›¾åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·æ£€æŸ¥å®¹å™¨DOMæ˜¯å¦å­˜åœ¨');
        }

        // çª—å£ resize äº‹ä»¶
        window.addEventListener('resize', function() {
            Object.values(charts).forEach(chart => {
                try {
                    chart.resize();
                } catch (err) {
                    console.error('å›¾è¡¨resizeé”™è¯¯ï¼š', err);
                }
            });
        });

        console.log('æ‰€æœ‰å›¾è¡¨å®ä¾‹åˆå§‹åŒ–æˆåŠŸ');
    } catch (err) {
        console.error('å›¾è¡¨åˆå§‹åŒ–å¤±è´¥ï¼š', err);
        showAlert('å›¾è¡¨åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·æ£€æŸ¥EChartsæ˜¯å¦æ­£ç¡®å¼•å…¥');
    }
}

// æ¸²æŸ“æ‰€æœ‰é¥¼å›¾ï¼ˆç§»é™¤å›¾ä¾‹ï¼Œä¼˜åŒ–æ ‡ç­¾æ˜¾ç¤ºï¼‰
function renderPieCharts() {
    try {
        renderFailReasonChart('ado', 'reqFailReasons', charts.adoReqFail);
        renderFailReasonChart('adi', 'reqFailReasons', charts.adiReqFail);
        renderFailReasonChart('adn', 'reqFailReasons', charts.adnReqFail);
        renderFailReasonChart('ado', 'displayFailReasons', charts.adoDisplayFail);
        renderFailReasonChart('adi', 'displayFailReasons', charts.adiDisplayFail);
        renderFailReasonChart('adn', 'displayFailReasons', charts.adnDisplayFail);
        
        renderDistributionChart(charts.countryDistribution, countryStats, 'å›½å®¶', (code) => {
            return `${code}(${countryCodeMap[code] || 'æœªçŸ¥å›½å®¶'})`;
        });
        
        renderDistributionChart(charts.modelDistribution, modelStats, 'æœºå‹');

        console.log('é¥¼å›¾æ¸²æŸ“æˆåŠŸ');
    } catch (err) {
        console.error('é¥¼å›¾æ¸²æŸ“å¤±è´¥ï¼š', err);
        showAlert('é¥¼å›¾æ¸²æŸ“å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ•°æ®æ ¼å¼');
    }
}

// æ¸²æŸ“å¤±è´¥åŸå› é¥¼å›¾ï¼ˆç§»é™¤å›¾ä¾‹ï¼Œä¼˜åŒ–æ ‡ç­¾ï¼‰
function renderFailReasonChart(adType, reasonType, chartInstance) {
    const reasons = adStats[adType][reasonType];
    const data = Object.entries(reasons).map(([name, value]) => ({
        name: String(name),
        value: Number(value)
    })).filter(item => item.value > 0);

    const option = {
        tooltip: {
            trigger: 'item',
            formatter: '{b}: {c} ({d}%)',
            textStyle: { fontSize: 12 }
        },
        // ç§»é™¤legendé…ç½®
        series: [{
            name: 'å¤±è´¥åŸå› ',
            type: 'pie',
            radius: ['45%', '70%'],
            center: ['50%', '50%'],
            avoidLabelOverlap: false,
            // ä¼˜åŒ–æ ‡ç­¾æ˜¾ç¤ºï¼Œç›´æ¥åœ¨é¥¼å›¾ä¸Šæ˜¾ç¤ºåç§°å’Œæ•°å€¼
            label: {
                show: true,
                position: 'outside',
                formatter: '{b}: {c}',
                fontSize: 11,
                overflow: 'break',
                lineOverflow: 'truncate',
                width: 100
            },
            labelLine: {
                show: true,
                length: 10,
                length2: 20,
                lineStyle: {
                    width: 0.8
                }
            },
            data: data.length > 0 ? data : [{ name: 'æ— å¤±è´¥æ•°æ®', value: 1 }],
            color: ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FECA57', '#FF9FF3', '#54A0FF', '#5F27CD', '#00D2D3']
        }]
    };

    if (chartInstance && chartInstance.setOption) {
        chartInstance.setOption(option);
    }
}

// æ¸²æŸ“åˆ†å¸ƒé¥¼å›¾ï¼ˆåœ°åŸŸ/æœºå‹ï¼Œç§»é™¤å›¾ä¾‹ï¼‰
function renderDistributionChart(chartInstance, statsData, name, formatName = (name) => name) {
    const data = Object.entries(statsData).map(([name, value]) => ({
        name: formatName(String(name)),
        value: Number(value)
    })).filter(item => item.value > 0)
      .sort((a, b) => b.value - a.value);

    const option = {
        tooltip: {
            trigger: 'item',
            formatter: '{b}: {c} ({d}%)',
            textStyle: { fontSize: 12 }
        },
        // ç§»é™¤legendé…ç½®
        series: [{
            name: name,
            type: 'pie',
            radius: ['45%', '70%'],
            center: ['50%', '50%'],
            avoidLabelOverlap: false,
            // ä¼˜åŒ–æ ‡ç­¾æ˜¾ç¤º
            label: {
                show: true,
                position: 'outside',
                formatter: '{b}: {c}',
                fontSize: 11,
                overflow: 'break',
                lineOverflow: 'truncate',
                width: 100
            },
            labelLine: {
                show: true,
                length: 10,
                length2: 20,
                lineStyle: {
                    width: 0.8
                }
            },
            data: data.length > 0 ? data : [{ name: `æ— ${name}æ•°æ®`, value: 1 }],
            color: ['#4CAF50', '#8BC34A', '#CDDC39', '#FFEB3B', '#FFC107', '#FF9800', '#FF5722', '#795548', '#9E9E9E', '#607D8B']
        }]
    };

    if (chartInstance && chartInstance.setOption) {
        chartInstance.setOption(option);
    }
}

// æŠ˜çº¿å›¾æ¸²æŸ“ä¼˜åŒ–ï¼ˆé‡ç‚¹ä¿®å¤ï¼Œç¡®ä¿æ¸²æŸ“æˆåŠŸï¼‰
function renderLineChart() {
    try {
        // 1. éªŒè¯å›¾è¡¨å®ä¾‹æ˜¯å¦å­˜åœ¨
        if (!charts.installTrend) {
            console.error('æŠ˜çº¿å›¾å®ä¾‹ä¸å­˜åœ¨');
            showAlert('æŠ˜çº¿å›¾å®ä¾‹æœªåˆå§‹åŒ–ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
            return;
        }

        // 2. å¤„ç†å®‰è£…è¶‹åŠ¿æ•°æ®ï¼ˆç¡®ä¿æ•°æ®æ ¼å¼æ­£ç¡®ï¼‰
        if (Object.keys(installTrendData).length === 0) {
            console.log('æ— å®‰è£…è¶‹åŠ¿æ•°æ®ï¼Œæ¸²æŸ“ç©ºå›¾è¡¨');
            const emptyOption = {
                tooltip: { trigger: 'axis' },
                grid: { left: '5%', right: '5%', bottom: '15%', top: '40px', containLabel: true },
                xAxis: { type: 'category', data: [], axisLabel: { rotate: 45 } },
                yAxis: { type: 'value', min: 0 },
                series: [{
                    name: 'å®‰è£…æ•°é‡',
                    type: 'line',
                    data: [],
                    label: { show: false }
                }],
                graphic: {
                    elements: [{
                        type: 'text',
                        left: 'center',
                        top: 'middle',
                        style: {
                            text: 'æš‚æ— å®‰è£…è¶‹åŠ¿æ•°æ®',
                            fontSize: 14,
                            fill: '#999'
                        }
                    }]
                }
            };
            charts.installTrend.setOption(emptyOption);
            return;
        }

        // 3. æŒ‰æœ¬åœ°æ—¶é—´æ’åºæ—¥æœŸï¼ˆç¡®ä¿æ—¶é—´è½´æ­£ç¡®ï¼‰
        const dates = Object.keys(installTrendData).sort((a, b) => {
            const dateA = new Date(a);
            const dateB = new Date(b);
            return dateA - dateB;
        });

        // 4. ç¡®ä¿æ•°å€¼ä¸ºæ•°å­—ç±»å‹
        const values = dates.map(date => {
            const val = Number(installTrendData[date]);
            return isNaN(val) ? 0 : val;
        });

        console.log('æŠ˜çº¿å›¾æ•°æ®ï¼š', { dates, values });

        // 5. ä¼˜åŒ–æŠ˜çº¿å›¾é…ç½®
        const option = {
            tooltip: {
                trigger: 'axis',
                formatter: '{b}: {c} æ¬¡å®‰è£…',
                axisPointer: { type: 'line', lineStyle: { color: '#ccc' } },
                textStyle: { fontSize: 12 }
            },
            legend: {
                data: ['å®‰è£…æ•°é‡'],
                top: 10,
                textStyle: { fontSize: 12 }
            },
            grid: {
                left: '8%',
                right: '5%',
                bottom: '20%', // å¢åŠ åº•éƒ¨è¾¹è·ï¼Œé¿å…xè½´æ ‡ç­¾è¢«æˆªæ–­
                top: '50px',
                containLabel: true
            },
            xAxis: {
                type: 'category',
                boundaryGap: true, // æ”¹ä¸ºtrueï¼Œé¿å…é¦–å°¾æ•°æ®è´´è¾¹
                data: dates,
                axisLabel: {
                    rotate: 45,
                    fontSize: 11,
                    interval: dates.length > 10 ? Math.floor(dates.length / 10) : 0, // æ—¥æœŸè¿‡å¤šæ—¶è‡ªåŠ¨é—´éš”æ˜¾ç¤º
                    margin: 10
                },
                axisLine: { lineStyle: { color: '#ccc' } },
                splitLine: { show: false }
            },
            yAxis: {
                type: 'value',
                min: 0,
                axisLabel: { 
                    formatter: '{value}',
                    fontSize: 11
                },
                splitLine: { lineStyle: { type: 'dashed', color: '#eee' } },
                axisLine: { lineStyle: { color: '#ccc' } },
                // ç¡®ä¿yè½´åˆ»åº¦ä¸ºæ•´æ•°
                axisTick: {
                    formatter: function(value) {
                        return value % 1 === 0 ? value : '';
                    }
                }
            },
            series: [{
                name: 'å®‰è£…æ•°é‡',
                type: 'line',
                data: values,
                smooth: true,
                symbol: 'circle',
                symbolSize: 6,
                lineStyle: { width: 2.5, color: '#4CAF50' },
                itemStyle: { 
                    color: '#4CAF50', 
                    borderColor: '#fff', 
                    borderWidth: 1.5,
                    shadowBlur: 3,
                    shadowColor: 'rgba(76, 175, 80, 0.5)'
                },
                areaStyle: {
                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                        offset: 0, color: 'rgba(76, 175, 80, 0.3)'
                    }, {
                        offset: 1, color: 'rgba(76, 175, 80, 0.05)'
                    }])
                },
                // æ˜¾ç¤ºæ•°å€¼æ ‡ç­¾ï¼ˆå¯é€‰ï¼‰
                label: {
                    show: values.length <= 10, // æ•°æ®ç‚¹å°‘äº10ä¸ªæ—¶æ˜¾ç¤ºæ•°å€¼
                    position: 'top',
                    fontSize: 10,
                    color: '#333'
                }
            }],
            animation: true,
            animationDuration: 1000
        };

        // 6. æ¸²æŸ“å›¾è¡¨
        charts.installTrend.setOption(option, true); // ç¬¬äºŒä¸ªå‚æ•°trueè¡¨ç¤ºæ¸…ç©ºä¹‹å‰çš„é…ç½®
        console.log('æŠ˜çº¿å›¾æ¸²æŸ“æˆåŠŸ');

    } catch (err) {
        console.error('æŠ˜çº¿å›¾æ¸²æŸ“å¤±è´¥è¯¦æƒ…ï¼š', err);
        showAlert('æŠ˜çº¿å›¾æ¸²æŸ“å¤±è´¥ï¼š' + err.message);
        
        // æ¸²æŸ“é”™è¯¯æç¤ºå›¾è¡¨
        if (charts.installTrend) {
            const errorOption = {
                grid: { left: 0, right: 0, top: 0, bottom: 0 },
                graphic: {
                    elements: [{
                        type: 'text',
                        left: 'center',
                        top: 'middle',
                        style: {
                            text: 'æŠ˜çº¿å›¾æ¸²æŸ“å¤±è´¥\n' + err.message,
                            fontSize: 12,
                            fill: '#f44336',
                            textAlign: 'center'
                        }
                    }]
                }
            };
            charts.installTrend.setOption(errorOption);
        }
    }
}

// æ’åºç”¨æˆ·åˆ—è¡¨
function sortUserList(sortType) {
    const [field, order] = sortType.split('-');
    const desc = order === 'desc';

    userDataList.sort((a, b) => {
        let valA, valB;

        switch (field) {
            case 'installTime':
                valA = a.installTime;
                valB = b.installTime;
                break;
            case 'adoShowRate':
                valA = a.ado.showRate;
                valB = b.ado.showRate;
                break;
            case 'adiShowRate':
                valA = a.adi.showRate;
                valB = b.adi.showRate;
                break;
            case 'adnShowRate':
                valA = a.adn.showRate;
                valB = b.adn.showRate;
                break;
            default:
                valA = a.installTime;
                valB = b.installTime;
        }

        return desc ? (valB - valA) : (valA - valB);
    });
}

// æ¸²æŸ“ç”¨æˆ·åˆ—è¡¨
function renderUserList() {
    const container = $('#userListContainer');
    container.empty();

    if (userDataList.length === 0) {
        container.append('<div style="text-align: center; padding: 20px; color: #757575;">æš‚æ— ç¬¦åˆæ¡ä»¶çš„ç”¨æˆ·æ•°æ®</div>');
        return;
    }

    userDataList.forEach((user, index) => {
        const userIdShort = user.userId.slice(-8);
        const installTimeFormatted = formatTimestamp(user.installTime); // æœ¬åœ°æ—¶é—´
        const countryName = countryCodeMap[user.country] || 'æœªçŸ¥å›½å®¶';
        const langName = langCodeMap[user.lang] || 'æœªçŸ¥è¯­è¨€';

        const userItem = $(`
            <div class="user-item" data-index="${index}">
                <div class="user-info-row">
                    <div class="user-info-label">ç”¨æˆ·ID:</div>
                    <div class="user-info-value">${userIdShort} (${user.userId})</div>
                </div>
                <div class="user-info-row">
                    <div class="user-info-label">å®‰è£…æ—¶é—´:</div>
                    <div class="user-info-value">${installTimeFormatted}</div>
                </div>
                <div class="user-info-row">
                    <div class="user-info-label">ç‰ˆæœ¬/å›½å®¶:</div>
                    <div class="user-info-value">${user.version} / ${user.country}(${countryName})</div>
                </div>
                <div class="user-info-row">
                    <div class="user-info-label">æœºå‹/è¯­è¨€:</div>
                    <div class="user-info-value">${user.model} / ${user.lang}(${langName})</div>
                </div>
                <div class="user-info-row">
                    <div class="user-info-label">å±•ç¤ºç‡:</div>
                    <div class="user-info-value">
                        <div class="rate-group">
                            <div class="rate-item">
                                <div class="rate-type">å¼€å±</div>
                                <div class="rate-value-small">${user.ado.showRate.toFixed(2)}%</div>
                            </div>
                            <div class="rate-item">
                                <div class="rate-type">æ’é¡µ</div>
                                <div class="rate-value-small">${user.adi.showRate.toFixed(2)}%</div>
                            </div>
                            <div class="rate-item">
                                <div class="rate-type">åŸç”Ÿ</div>
                                <div class="rate-value-small">${user.adn.showRate.toFixed(2)}%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `);

        userItem.click(function() {
            $('.user-item').removeClass('active');
            $(this).addClass('active');
            const userIndex = $(this).data('index');
            showUserEvents(userDataList[userIndex]);
        });

        container.append(userItem);
    });
}

// æ˜¾ç¤ºç”¨æˆ·äº‹ä»¶è¯¦æƒ…ï¼ˆæœ¬åœ°æ—¶é—´ï¼‰
function showUserEvents(user) {
    const emptyTip = $('#eventEmptyTip');
    const detailContainer = $('#eventDetailContainer');
    const eventList = $('#eventList');
    const subtitle = $('#eventUserSubtitle');

    emptyTip.hide();
    detailContainer.show();

    const userIdShort = user.userId.slice(-8);
    subtitle.text(`ç”¨æˆ·ID: ${user.userId} (${userIdShort}) | ç‰ˆæœ¬: ${user.version} | å®‰è£…æ—¶é—´: ${formatTimestamp(user.installTime)}`);

    eventList.empty();

    if (user.events.length === 0) {
        eventList.append('<div style="text-align: center; padding: 20px; color: #757575;">è¯¥ç”¨æˆ·æš‚æ— äº‹ä»¶è®°å½•</div>');
        return;
    }

    user.events.forEach(event => {
        const eventTime = formatTimestamp(event.timestamp); // æœ¬åœ°æ—¶é—´
        let extraHtml = '';
        if (event.extra && event.extra !== '{}') {
            extraHtml = `<div class="event-extra">é¢å¤–ä¿¡æ¯: ${event.extra}</div>`;
        }
        let failReasonHtml = '';
        if (event.failReason) {
            failReasonHtml = `<span style="color: #E57373; margin-left: 8px;">[å¤±è´¥: ${event.failReason}]</span>`;
        }

        const eventItem = $(`
            <div class="event-item">
                <div>
                    <div class="event-name">${event.type === 'ad_event' ? '[å¹¿å‘Šäº‹ä»¶]' : '[é¡µé¢äº‹ä»¶]'} ${event.eventName} ${failReasonHtml}</div>
                    ${extraHtml}
                </div>
                <div class="event-time">${eventTime}</div>
            </div>
        `);

        eventList.append(eventItem);
    });
}

// æ˜¾ç¤ºæç¤ºå¼¹çª—
function showAlert(message) {
    $('#alertMessage').text(message);
    $('#alertModal').show();
}

// å›¾è¡¨é”€æ¯
window.addEventListener('beforeunload', function() {
    Object.values(charts).forEach(chart => {
        try {
            chart.dispose();
        } catch (err) {
            console.error('å›¾è¡¨é”€æ¯é”™è¯¯ï¼š', err);
        }
    });
});
    </script>

</body> 
</html> 

<!-- # è§’è‰²æè¿°
ä½ æ˜¯ä¸€ä¸ªèµ„æ·±çš„å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ, å°¤å…¶æ˜¯éå¸¸æ“…é•¿æ•°æ®åˆ†æ, ç”¨echartsç»˜åˆ¶å„ç§å„æ ·çš„å›¾è¡¨; ç°åœ¨éœ€è¦å¼€å‘ä¸€ä¸ªç½‘é¡µæ¥åˆ†æç”¨æˆ·æœ¬åœ°æ˜¯ä¸€ä¸ªjsonæ•°æ®, jsonæ•°æ®æˆ‘ä¼šé€šè¿‡æ ·æœ¬ç»™ä½ . 

## jsonç»“æ„åˆ†æ
jsonå†…éƒ¨æœ‰å¾ˆå¤šç”¨æˆ·çš„ä¿¡æ¯, æ¯ä¸€ä»½éƒ½æ˜¯ç”¨æˆ·id(å¦‚:1B2A3849-7B91-4224-8509-12C719E65EC0), ä»¥åŠå¯¹åº”çš„ç”¨æˆ·ç›¸å…³ä¿¡æ¯[å‚è€ƒjsonæ ·æœ¬], ç¤ºä¾‹å¦‚ä¸‹:
1. 1B2A3849-7B91-4224-8509-12C719E65EC0/userinfo: è¿™ä¸ªæ¨¡å—ä¸»è¦ç”¨æ¥å­˜å‚¨ç”¨æˆ·çš„å®‰è£…ç›¸å…³ä¿¡æ¯
    version: ç‰ˆæœ¬å·, country: å›½å®¶, id: ç”¨æˆ·id, install_time: ç”¨æˆ·å®‰è£…æ—¶é—´, lan: è¯­è¨€, model: è®¾å¤‡æè¿°, resolution: åˆ†è¾¨ç‡, scale: ç¼©æ”¾å› å­

2. 1B2A3849-7B91-4224-8509-12C719E65EC0/ad_event: è¿™ä¸ªæ¨¡å—ä¸»è¦å­˜å‚¨çš„æ˜¯æœ‰å…³å¹¿å‘Šçš„æ•°æ®, 
    event_name: äº‹ä»¶ç±»å‹, å–å€¼å¦‚ä¸‹:
        ado_req_start: å¼€å§‹è¯·æ±‚å¼€å±å¹¿å‘Š
        ado_req_success: å¼€å±å¹¿å‘Šè¯·æ±‚æˆåŠŸ
        ado_req_fail: å¼€å±å¹¿å‘Šè¯·æ±‚å¤±è´¥
        ado_display_start: å¼€å§‹å±•ç¤ºå¼€å±å¹¿å‘Š
        ado_display_success: å¼€å±å¹¿å‘Šå±•ç¤ºæˆåŠŸ
        ado_display_fail: å¼€å±å¹¿å‘Šå±•ç¤ºå¤±è´¥
        ado_click: ç‚¹å‡»å¼€å±å¹¿å‘Š

        adi_req_start: å¼€å§‹è¯·æ±‚æ’é¡µå¹¿å‘Š
        adi_req_success: æ’é¡µå¹¿å‘Šè¯·æ±‚æˆåŠŸ
        adi_req_fail: æ’é¡µå¹¿å‘Šè¯·æ±‚å¤±è´¥
        adi_display_start: æ’é¡µå±•ç¤ºå¼€å±å¹¿å‘Š
        adi_display_success: æ’é¡µå¹¿å‘Šå±•ç¤ºæˆåŠŸ
        adi_display_fail: æ’é¡µå¹¿å‘Šå±•ç¤ºå¤±è´¥
        adi_click: ç‚¹å‡»æ’é¡µå¹¿å‘Š

        adn_req_start: å¼€å§‹è¯·æ±‚åŸç”Ÿå¹¿å‘Š
        adn_req_success: åŸç”Ÿå¹¿å‘Šè¯·æ±‚æˆåŠŸ
        adn_req_fail: åŸç”Ÿå¹¿å‘Šè¯·æ±‚å¤±è´¥ 
        adn_display_success: åŸç”Ÿå¹¿å‘Šå±•ç¤ºæˆåŠŸ 
        adn_click: ç‚¹å‡»åŸç”Ÿå¹¿å‘Š
    timestamp: æ—¶é—´æˆ³. 
    fail_reason: å±•ç¤º/è¯·æ±‚å¤±è´¥åŸå› 

3. 1B2A3849-7B91-4224-8509-12C719E65EC0/vc_event: è¿™ä¸ªæ¨¡å—ä¸»è¦å­˜å‚¨çš„æ˜¯æœ‰å…³ç”¨æˆ·é¡µé¢å˜åŒ–çš„æ•°æ®,
    event_name: äº‹ä»¶ç±»å‹
    timestamp: æ—¶é—´æˆ³. 
    ä»¥åŠå…¶ä»–å­—æ®µ, æœ€åå°†åœ¨åˆ—è¡¨ä¸­æ˜¾ç¤º
    ä»¥ä¸Šå°±æ˜¯jsonæ ¼å¼åŠå†…å®¹è¯´æ˜


 # éœ€æ±‚è¯¦è¿°;
 - æœ€ç»ˆç”Ÿæˆä¸€ä¸ªhtmlæ–‡ä»¶, å†…éƒ¨åˆ©ç”¨jsåˆ†æjsonæ•°æ®å¹¶æ˜¾ç¤ºæˆ–è€…ç»˜åˆ¶è®¡ç®—ç»“æœ.
 - é¡µé¢å†…å®¹è‡ªä¸Šè€Œä¸‹è¿›è¡Œæè¿°:
    1. part1, å·¦å³ç»“æ„åˆ†å¸ƒ:
       å³ä¾§ä¸ºä¸€ä¸ªæ˜¾ç¤ºä»£ç å—çš„åŒºåŸŸ, å¹¶ä¸”æ”¯æŒå¤åˆ¶æ“ä½œå’Œæ¸…ç©ºæ­¤ä»£ç å—çš„æ“ä½œ
       å·¦ä¾§: å‚ç›´åˆ†å¸ƒ2ä¸ªæŒ‰é’®
            button1: æ ‡é¢˜: é€‰æ‹©jsonæ–‡ä»¶, æè¿°: é€‰æ‹©å®Œæˆåç”¨æ¥æ˜¾ç¤ºjsonè·¯å¾„å’Œåç§°; ç‚¹å‡»ä¹‹åå†æœ¬åœ°é€‰æ‹©jsonæ–‡ä»¶;
            button2: æ ‡é¢˜; è§£æ, æè¿°: è®¡ç®—ç»“æœ;  å¦‚æœbutton1è¿˜æ²¡æœ‰é€‰æ‹©jsonæ–‡ä»¶, åˆ™å¼¹çª—æç¤º"è¯·å…ˆé€‰æ‹©jsonæ–‡ä»¶"; è§£æè¿‡ç¨‹ä¸­å±•ç¤ºloading, è§£æé”™è¯¯æç¤ºé”™è¯¯åŸå› , è§£ææˆåŠŸåå±•ç¤ºpart1ä¹‹åçš„å†…å®¹æ¥å±•ç¤ºå’Œæ¸²æŸ“è§£æç»“æœ; (é»˜è®¤è§£æè¿‘7å¤©çš„æ•°æ®);

    2. part2, æ¡ä»¶ç­›é€‰, å·¦å³ç»“æ„, æŒ‰ç…§å·¦å¯¹é½è¿›è¡Œæ’åˆ—
         é¦–å…ˆæ˜¯æ—¶é—´æ¨¡å—å¯ä»¥é€‰æ‹©æ—¶é—´(ä»Šå¤©/æ˜¨å¤©/è¿‘3å¤©/è¿‘7å¤©/è¿‘30å¤©/è¿‘90å¤©/è¿‘360å¤©), é€‰æ‹©å¯¹åº”çš„æ—¶é—´ä¹‹å(éœ€è¦æ˜¾ç¤ºå…·ä½“çš„èµ·æ­¢æ—¶é—´, å¦‚2025-11-11 ~ 1025-11-12), å¼€å§‹é‡æ–°è§£æå¹¶ä¸”åˆ·æ–°è§£æç»“æœ; æ¥ä¸‹æ¥æ˜¯ç‰ˆæœ¬é€‰æ‹©, ä¸‹æ‹‰åˆ—è¡¨æŒ‰ç…§é™åºæ˜¾ç¤ºç‰ˆæœ¬å·åˆ—è¡¨. å¹¶ä¸”åœ¨ç¬¬ä¸€ä¸ªæ˜¾ç¤ºall, é€‰æ‹©å¯¹åº”çš„ç‰ˆæœ¬åˆ™å¼€å§‹è§£ææ‰€é€‰æ—¶é—´æ®µå†…å¯¹åº”ç‰ˆæœ¬çš„æ•°æ®, é€‰æ‹©all, å¼€å§‹è§£ææ‰€é€‰æ—¶é—´æ®µå†…æ‰€æœ‰ç‰ˆæœ¬çš„æ•°æ®; 
         å½“é¡µé¢å‘ä¸Šæ»‘åŠ¨çš„è¿‡ç¨‹ä¸­, è¿™ä¸ªæ¨¡å—æœ€å¥½é¡¶åˆ°æµè§ˆå™¨é¡¶éƒ¨ä¸è·Ÿéšæ»‘åŠ¨, ä¾¿äºç­›é€‰, ä¹Ÿä¾¿äºçŸ¥é“å½“å‰åˆ†æçš„æ•°æ®ä¿¡æ¯;

    3. part3, æ•°æ®æ€»è§ˆ, ä¸Šä¸‹ç»“æ„
         ä¸Šè¾¹æ˜¾ç¤ºæ•°æ®æ€»è§ˆæ ‡é¢˜å’Œå®‰è£…æ•°é‡(é€šè¿‡jsonä¸­æœ‰å¤šå°‘æ¡ç‹¬ç«‹ç”¨æˆ·idä¿¡æ¯æ¥ç»Ÿè®¡), é«˜åº¦å¯ä»¥ç¨å¾®å°ä¸€ç‚¹;
         ä¸‹è¾¹éœ€è¦ç”¨è¡¨æ ¼æ¥æ˜¾ç¤º:
         0. ç¬¬0åˆ—æ˜¾ç¤ºç±»å‹: ç±»å‹, åŒ¹é…ç‡, å±•ç¤ºç‡, ç‚¹å‡»ç‡, äººå‡å±•ç¤ºä¸ªæ•°, æ€»æ•°(req/s/f - dis_s/dis_f)
         1. ç¬¬1åˆ—æ˜¾ç¤º: å¼€å±å¹¿å‘Š, æ’é¡µå¹¿å‘Š, åŸç”Ÿå¹¿å‘Š, å¹³å‡æ•°æ®
         2. ç¬¬2åˆ—æ˜¾ç¤ºå¯¹åº”çš„å¹¿å‘Šç±»å‹çš„åŒ¹é…ç‡ä»¥åŠå¹³å‡åŒ¹é…ç‡ (åŒ¹é…ç‡ = è¯·æ±‚æˆåŠŸçš„/è¯·æ±‚å¼€å§‹çš„ * 100%)
         3. ç¬¬3åˆ—æ˜¾ç¤ºå¯¹åº”çš„å¹¿å‘Šç±»å‹çš„å±•ç¤ºç‡ä»¥åŠå¹³å‡å±•ç¤ºç‡ (å±•ç¤ºç‡ = å±•ç¤ºæˆåŠŸçš„/è¯·æ±‚æˆåŠŸçš„ * 100%)
         4. ç¬¬4åˆ—æ˜¾ç¤ºå¯¹åº”çš„å¹¿å‘Šç±»å‹çš„ç‚¹å‡»ç‡ä»¥åŠå¹³å‡ç‚¹å‡»ç‡ (ç‚¹å‡»ç‡ = ç‚¹å‡»çš„/å±•ç¤ºæˆåŠŸçš„ * 100%)
         5. ç¬¬5åˆ—æ˜¾ç¤ºå¯¹åº”çš„å¹¿å‘Šç±»å‹çš„äººå‡å±•ç¤ºä¸ªæ•° (å¦‚å¼€å±å¹¿å‘Šçš„äººå‡å±•ç¤ºæ•° = æ‰€é€‰æ—¶é—´æ®µå’Œç‰ˆæœ¬çš„å¼€å±å¹¿å‘Šå±•ç¤ºæˆåŠŸçš„æ€»æ•°é‡/æ‰€é€‰æ—¶é—´æ®µå’Œç‰ˆæœ¬çš„ç”¨æˆ·æ€»æ•°; ç²¾ç¡®åˆ°å°æ•°ç‚¹å2ä½)
         6. ç¬¬6åˆ—æ˜¾ç¤ºä¸€äº›é™„ä»¶æ•°æ®, å¹³å‡æ•°æ®ä¸å‚ä¸è®¡ç®—, reqä»£è¡¨å¯¹åº”å¹¿å‘Šç±»å‹å‘èµ·è¯·æ±‚çš„æ€»æ•°, sä»£è¡¨è¯·æ±‚æˆåŠŸæ€»æ•°, fä»£è¡¨è¯·æ±‚å¤±è´¥æ€»æ•°, dis_sä»£è¡¨å±•ç¤ºæˆåŠŸæ€»æ•°, dis_fä»£è¡¨å±•ç¤ºå¤±è´¥æ€»æ•°, æ˜¾ç¤ºæ ¼å¼å°±æŒ‰ç…§: req/s/f - dis_s/dis_f

    4. part4, é¥¼å›¾éƒ¨åˆ†, éœ€è¦ç”¨echartç»˜åˆ¶é¥¼å›¾, æ•´ä¸ªæ¨¡å—åˆ†ä¸º3ä¸ªéƒ¨åˆ†
        1. æ¨¡å—çš„ç¬¬ä¸€éƒ¨åˆ†æ°´å¹³æ˜¾ç¤ºä¸‰ç§å¹¿å‘Šç±»å‹çš„è¯·æ±‚å¤±è´¥åŸå› , è¯·æ±‚å¤±è´¥åŸå› é¥¼å›¾(æ ¹æ®ado_req_failå¹¶åˆ—çš„fail_reasonå­—æ®µè®¡ç®—, æ’é¡µå’ŒåŸç”Ÿç±»ä¼¼)
        2. æ¨¡å—çš„ç¬¬äºŒéƒ¨åˆ†æ°´å¹³æ˜¾ç¤ºä¸‰ç§å¹¿å‘Šç±»å‹çš„å±•ç¤ºå¤±è´¥åŸå› , è¯·æ±‚å¤±è´¥åŸå› é¥¼å›¾(æ ¹æ®ado_display_failå¹¶åˆ—çš„fail_reasonå­—æ®µè®¡ç®—, æ’é¡µå’ŒåŸç”Ÿç±»ä¼¼)
        3. æ¨¡å—çš„ç¬¬ä¸‰ä¸ªéƒ¨åˆ†å·¦ä¾§æ˜¾ç¤º åœ°åŸŸåˆ†å¸ƒé¥¼å›¾(æ ¹æ®countryå­—æ®µè®¡ç®—), éœ€è¦æ˜¾ç¤ºæ•°é‡ä¸ªå æ¯”, å¹¶ä¸”åœ¨å›½å®¶ä»£ç åæ˜¾ç¤ºå›½å®¶åç§°å¦‚US(ç¾å›½), è¯·ä½ è‡ªå·±æ ¹æ®jsonä¸­çš„å›½å®¶ä»£ç è®¡ç®—å¯¹åº”çš„å›½å®¶åç§°
        4. æ¨¡å—çš„ç¬¬ä¸‰ä¸ªéƒ¨åˆ†å³ä¾§æ˜¾ç¤º æœºå‹åˆ†å¸ƒé¥¼å›¾(æ ¹æ®modelå­—æ®µè®¡ç®—)
    5. part5, æŠ˜çº¿å›¾éƒ¨åˆ†, å®‰è£…æ•°é‡éšç€æ—¶é—´å˜åŒ–çš„æ›²çº¿å›¾(æ ¹æ®userinfoå­—æ®µä¸‹å†…å®¹è®¡ç®—), ç”¨åœ†æ»‘çš„æ›²çº¿å›¾, ä¸è¦ç”¨ç”Ÿç¡¬çš„æŠ˜çº¿;
    6. part6, ç”¨æˆ·åˆ—è¡¨éƒ¨åˆ†,  åˆ†ä¸ºå·¦å³ç»“æ„, å·¦ä¾§å±•ç¤ºç”¨æˆ·åˆ—è¡¨, å³ä¾§ç”¨æ¥å±•ç¤ºäº‹ä»¶è¯¦æƒ…; ä¸è¦ç”¨ä¸Šä¸‹ç»“æ„æ˜¾ç¤º, ä¸åˆ©äºæ“ä½œ.
        å·¦ä¾§å±•ç¤ºç”¨æˆ·åˆ—è¡¨(List), æ¯ä¸ªListä¸­çš„å…ƒç´ éœ€è¦æ˜¾ç¤ºå†…å®¹å¦‚ä¸‹: ç”¨æˆ·id(å±•ç¤ºå8ä½å³å¯), å®‰è£…æ—¶é—´, å±•ç¤ºç‡å’ŒåŒ¹é…ç‡(å¼€å±,æ’é¡µ,åŸç”Ÿä¸‰ç§ç±»å‹éƒ½è¦å±•ç¤º),ç‰ˆæœ¬å·(version), å›½å®¶(å›½å®¶ä»£ç å’Œåç§°), æœºå‹, è¯­è¨€(è¯­è¨€ä»£ç å’Œè¯­è¨€åç§°); åˆ—è¡¨å¯ä»¥æŒ‰ç…§å®‰è£…æ—¶é—´å‡åºæˆ–è€…é™åºæ’åˆ—, æŒ‰ç…§ä¸‰ç§å±•ç¤ºç‡å‡åºæˆ–è€…é™åºæ’åˆ—, ç‚¹å‡»æ¯ä¸€ä¸ªç”¨æˆ·å, å³ä¾§åŒºåŸŸç”¨åˆ—è¡¨æ˜¾ç¤ºç”¨æˆ·çš„æ“ä½œè®°å½•(event_nameå­—æ®µéœ€è¦æ˜¾ç¤ºåœ¨æœ€å‰è¾¹, æœ€åæ˜¾ç¤ºæ—¶é—´, å­—ä½“å¯ä»¥ç¨å¾®å°ä¸€ç‚¹é¢œè‰²æ·¡ä¸€ç‚¹) 

 - é¡µé¢é£æ ¼; ç®€çº¦ä¼˜é›…, æŠ¤çœ¼, å°½é‡åç»¿è‰²ç³».
 - æ—¶é—´æˆ³: æ‰€æœ‰çš„æ—¶é—´æˆ³éƒ½éœ€è¦æ ¼å¼åŒ–ä¸ºæœ¬åœ°æ—¶é—´, ç²¾ç¡®åˆ°æ¯«ç§’
 - çº¦æŸ:
    - å…³äºechartç›¸å…³çš„cdnåœ°å€, æŒ‘é€Ÿåº¦å¿«çš„ç”¨, ä¸çŸ¥è¿™ä¸ªcdnåœ°å€å¦‚ä½•: https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js
    - è®¡ç®—å®Œæˆä¹‹åå°†å›¾æ ‡å’Œå…¶ä»–å†…å®¹ä¸€èµ·æ¸²æŸ“å‡ºæ¥, ä¸å¯ä»¥å‡ºç°æ–‡å­—å‡ºç°äº†, ä½†æ˜¯å›¾è¡¨éš”äº†å¥½ä¸€ä¼šæ‰å‡ºæ¥.
  - å›½å®¶ä»£ç å’Œè¯­è¨€ä»£ç åˆ¤æ–­çš„æ—¶å€™ä¸åŒºåˆ†å¤§å°å†™


# æ ·æœ¬
 ## jsonæ ·æœ¬:
 {
  "1B2A3849-7B91-4224-8509-12C719E65EC0": {
    "ad_event": {
      "-OdrJ9j5WYBnj6j6mycU": {
        "event_name": "ad_open_req_start",
        "timestamp": 1762938367.034358
      },
      "-OdrJAXuex9O4Oxct644": {
        "event_name": "ad_open_req_success",
        "timestamp": 1762938370.327163
      },
      "-OdrJAXuex9O4Oxct645": {
        "event_name": "ad_open_display",
        "timestamp": 1762938370.330896
      },
      "-OdrJHWu-Mu0c9w3iHBc": {
        "event_name": "ad_open_display_success",
        "timestamp": 1762938398.934619
      },
      "-OdrJI5neS7P_Hy0TiEk": {
        "event_name": "ad_open_req_start",
        "timestamp": 1762938401.299559
      },
      "-OdrJIIFIoM55IC0jbZ3": {
        "event_name": "ad_open_req_success",
        "timestamp": 1762938402.0962129
      },
      "-OdrJIIFIoM55IC0jbZ4": {
        "event_name": "ad_open_display",
        "timestamp": 1762938402.096448
      },
      "-OdrJIIRaRc6da-2vK6E": {
        "event_name": "ad_open_display_success",
        "timestamp": 1762938402.108344
      }
    },
    "userinfo": {
      "event_name": "app_install",
      "country": "HK",
      "id": "34FF0878-646A-43EF-88BA-8A2B017C30B1",
      "install_time": 1762938365.976881,
      "lan": "en",
      "model": "iPhone",
      "resolution": "(402.0, 874.0)",
      "scale": 3,
      "timestamp": 1762938366.3004231,
      "version":"1.0"
    },
    "vc_event": {
      "-OdrJ9VV3FNTrg9OZkvN": {
        "event_name": "navi_push",
        "change_to": "HomeViewController",
        "current_is": "",
        "timestamp": 1762938365.973088
      },
      "-OdrJ9Vo8rQxtd8rMCOw": {
        "event_name": "navi_push",
        "change_to": "CreateAiFriendViewController",
        "current_is": "",
        "timestamp": 1762938366.004582
      },
      "-OdrJ9VqUhRvjLB1uh5P": {
        "event_name": "navi_push",
        "change_to": "MessageViewController",
        "current_is": "",
        "timestamp": 1762938366.006042
      },
      "-OdrJ9WlI8hbTRnT57q7": {
        "event_name": "window",
        "change_to": "TabBarViewController",
        "timestamp": 1762938366.062823
      },
      "-OdrJ9_RRUCe07ls277O": {
        "event_name": "app_launch",
        "open_times": 2,
        "timestamp": 1762938366.298266
      },
      "-OdrJJ6gDSiuIK1rCOnV": {
        "event_name": "present_dismiss",
        "current_is": "TabBarViewController",
        "timestamp": 1762938405.4508219
      }
    }
  }
 } -->
 

